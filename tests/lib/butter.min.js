!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Butter=t():e.Butter=t()}(this,()=>(()=>{"use strict";var n={d:(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},e={};n.d(e,{default:()=>function(e,t={}){if(e)return this instanceof r?r:new r(e,t);throw"ButterCMS API token not set"}});const O="2.0.0",s={author:"authors",category:"categories",content:"content",feed:"feeds",page:"pages",post:"posts",tag:"tags"};function P(e,t){const{onError:r,onRequest:n,onResponse:s,...a}=t.config,{auth_token:o,test:c,preview:i,...u}=t.params;r&&r(e,{options:a,params:u,type:t.type})}function x(e,t,r){t={auth_token:t};return r.testMode&&(t.test=1,t.preview=1),{...e,...t}}function a(y,q){t=y;const w=`https://api.buttercms.com/v2/${s[t]}/`,e=y.replace(y[0],y[0].toUpperCase()),{applyRequestUrlForErrorMessages:E,cancelRequest:b,cleanup:j,determineFetchError:k,signal:T}=function(t){let s=new AbortController,r="";function a(e){return r+": "+e}function o(){s=null}return{applyRequestUrlForErrorMessages:function(e){r=t+` (${e})`},cancelRequest:async function(){await s.abort(a("Request cancelled"))},cleanup:o,controller:s,determineFetchError:function(e,t){var r=s&&s.signal.reason&&s.signal.aborted,n="TimeoutError"===e.name;return r?s.signal.reason:n?a(`Request timed out after ${t}ms.`):(o(),e)},signal:s.signal}}(e);var t;async function r(t=w,r={}){const{apiToken:e,...n}=q,s=new Headers({"Content-Type":"application/json","X-Butter-Client":"JS/"+O});"undefined"==typeof window&&s.append("Accept-Encoding","gzip"),E(t);var{config:r,headers:a,params:o}=await async function(e,t,r){const{onError:n,onRequest:s,onResponse:a,...o}=r.config;var c,i;return s?({headers:e,options:c,params:i}=await s(e,{cancelRequest:r.cancelRequest,headers:r.headers,options:o,params:r.params,type:r.type}),{config:{...c,onError:n,onRequest:s,onResponse:a},headers:e,params:x(i,t,c)}):{...r,params:x(r.params,t,o)}}(t,e,{cancelRequest:b,config:n,headers:s,params:r,type:y});try{var c=AbortSignal.timeout(r.timeout),i=await fetch(t+"?"+new URLSearchParams(o),{cache:r.cache,method:"GET",headers:a,signal:AbortSignal.any([T,c])});if(j(),200!==i.status)throw{response:i,config:r,params:o};{var u=i;var p={config:r,params:o,type:y,requestHeaders:s};const{onError:l,onRequest:f,onResponse:d,...h}=p.config,{auth_token:m,test:g,preview:R,...v}=p.params;if(d){const l=u.clone();await d(l,{options:h,params:v,type:p.type})}return await{data:await u.json(),headers:Object.fromEntries(u.headers.entries()),status:u.status,statusText:u.statusText,config:{url:u.url,method:"get",headers:Object.fromEntries(p.requestHeaders.entries()),transformRequest:f?[f]:[],transformResponse:d?[d]:[],timeout:p.config.timeout}};return await void 0}}catch(e){return e.response?(t=await e.response.json(),a=Object.fromEntries(Object.entries(e.params).filter(([e])=>"auth_token"!==e)),(c=new URL(e.response.url)).searchParams.delete("auth_token"),P(t,i={data:t,headers:e.response.headers,status:e.response.status,statusText:e.response.statusText,config:e.config,params:a,type:y,url:c}),Promise.reject(new Error(`${u=t,p=Object.keys(u),1<p.length?`Errors caught in [${p.join(", ")}]: see cause for details`:`[${p[0]}]: `+u[p[0]]} (${e.response.status})`,{cause:i}))):(P(a=k(e,r.timeout),{config:r,params:o,type:y}),j(),Promise.reject(new Error(a)))}}return{cancelRequest:b,list:async function(e={}){return r(w,e)},retrieve:async function(e,t){return r(w+e+"/",t)},search:async function(e="",t={}){return t.query=e,r(w+"search/",t)}}}const u={Author:function(e={}){var{cancelRequest:e,list:t,retrieve:r}=a("author",e);return{cancelRequest:e,list:t,retrieve:r}},Category:function(e={}){var{cancelRequest:e,list:t,retrieve:r}=a("category",e);return{cancelRequest:e,list:t,retrieve:r}},Content:function(e={}){var{cancelRequest:e,retrieve:t}=a("content",e);return{cancelRequest:e,retrieve:t}},Feed:function(e={}){var{cancelRequest:e,retrieve:t}=a("feed",e);return{cancelRequest:e,retrieve:t}},Page:function(e={}){const{cancelRequest:t,retrieve:n,search:r}=a("page",e);return{cancelRequest:t,list:async(e,t)=>n(e,t),retrieve:async(e,t,r)=>n(e+"/"+t,r),search:r}},Post:function(e={}){var{cancelRequest:e,list:t,retrieve:r,search:n}=a("post",e);return{cancelRequest:e,list:t,retrieve:r,search:n}},Tag:function(e={}){var{cancelRequest:e,list:t,retrieve:r}=a("tag",e);return{cancelRequest:e,list:t,retrieve:r}}};function r(e,t){var r,n,{cache:t="default",onError:s=null,onRequest:a=null,onResponse:o=null,testMode:c=!1,timeout:i=3e3}=t;return{version:O,...(r=u,n={apiToken:e,cache:t,onError:s,onRequest:a,onResponse:o,testMode:c,timeout:i},Object.keys(r).reduce((e,t)=>({...e,[t.toLocaleLowerCase()]:r[t](n)}),{}))}}return e.default})());