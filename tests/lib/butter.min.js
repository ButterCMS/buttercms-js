!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Butter=t():e.Butter=t()}(this,()=>(()=>{"use strict";var n={d:(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},e={};n.d(e,{default:()=>function(e,t={}){if(e)return this instanceof r?r:new r(e,t);throw"ButterCMS API token not set"}});const C="2.0.0",o={author:"authors",category:"categories",content:"content",feed:"feeds",page:"pages",post:"posts",tag:"tags"};function P(e,t){const{onError:r,onRequest:n,onResponse:o,...a}=t.config,{auth_token:s,test:c,preview:i,...u}=t.params;r&&r(e,{options:a,params:u,type:t.type})}function k(e,t,r){t={auth_token:t};return r.testMode&&(t.test=1,t.preview=1),{...e,...t}}function a(h,v){t=h;const y=`https://api.buttercms.com/v2/${o[t]}/`,e=h.replace(h[0],h[0].toUpperCase()),{applyRequestUrlForErrorMessages:q,cancelRequest:w,cleanup:E,determineFetchError:b,signal:j}=function(t){let o=new AbortController,r="";function a(e){return r+": "+e}function s(){o=null}return{applyRequestUrlForErrorMessages:function(e){r=t+` (${e})`},cancelRequest:async function(){await o.abort(a("Request cancelled"))},cleanup:s,controller:o,determineFetchError:function(e,t){var r=o.signal.reason&&o.signal.aborted,n="TimeoutError"===e.name;return r?o.signal.reason:n?a(`Request timed out after ${t}ms.`):(s(),e)},signal:o.signal}}(e);var t;async function r(e=y,t={}){const{apiToken:r,...n}=v,o=new Headers({"Content-Type":"application/json","X-Butter-Client":"JS/"+C});"undefined"==typeof window&&o.append("Accept-Encoding","gzip"),q(e);var{config:t,headers:a,params:s}=await async function(e,t,r){const{onError:n,onRequest:o,onResponse:a,...s}=r.config;var c,i;return o?({headers:e,options:c,params:i}=await o(e,{cancelRequest:r.cancelRequest,headers:r.headers,options:s,params:r.params,type:r.type}),{config:{...c,onError:n,onRequest:o,onResponse:a},headers:e,params:k(i,t,c)}):{...r,params:k(r.params,t,s)}}(e,r,{cancelRequest:w,config:n,headers:o,params:t,type:h});try{const v=AbortSignal.timeout(t.timeout),C=await fetch(e+"?"+new URLSearchParams(s),{cache:t.cache,method:"GET",headers:a,signal:AbortSignal.any([j,v])});if(E(),200!==C.status)throw{response:C,config:t,params:s};{var c=C;var i={config:t,params:s,type:h};const{onError:u,onRequest:p,onResponse:l,...f}=i.config,{auth_token:d,test:m,preview:g,...R}=i.params;if(l){const u=c.clone();await l(u,{options:f,params:R,type:i.type})}return await c.json();return await void 0}}catch(e){if(e.response){const C=(await e.response.json())["detail"];return P(C,{config:e.config,params:e.params,type:h}),Promise.reject(new Error(C))}{const C=b(e,t.timeout);return P(C,{config:t,params:s,type:h}),E(),Promise.reject(new Error(C))}}}return{cancelRequest:w,list:async function(e={}){return r(y,e)},retrieve:async function(e,t){return r(y+e+"/",t)},search:async function(e="",t={}){return t.query=e,r(y+"search/",t)}}}const u={Author:function(e={}){var{cancelRequest:e,list:t,retrieve:r}=a("author",e);return{cancelRequest:e,list:t,retrieve:r}},Category:function(e={}){var{cancelRequest:e,list:t,retrieve:r}=a("category",e);return{cancelRequest:e,list:t,retrieve:r}},Content:function(e={}){var{cancelRequest:e,retrieve:t}=a("content",e);return{cancelRequest:e,retrieve:t}},Feed:function(e={}){var{cancelRequest:e,retrieve:t}=a("feed",e);return{cancelRequest:e,retrieve:t}},Page:function(e={}){const{cancelRequest:t,retrieve:n,search:r}=a("page",e);return{cancelRequest:t,list:async(e,t)=>n(e,t),retrieve:async(e,t,r)=>n(e+"/"+t,r),search:r}},Post:function(e={}){var{cancelRequest:e,list:t,retrieve:r,search:n}=a("post",e);return{cancelRequest:e,list:t,retrieve:r,search:n}},Tag:function(e={}){var{cancelRequest:e,list:t,retrieve:r}=a("tag",e);return{cancelRequest:e,list:t,retrieve:r}}};function r(e,t){var r,n,{cache:t="default",onError:o=null,onRequest:a=null,onResponse:s=null,testMode:c=!1,timeout:i=3e3}=t;return{version:C,...(r=u,n={apiToken:e,cache:t,onError:o,onRequest:a,onResponse:s,testMode:c,timeout:i},Object.keys(r).reduce((e,t)=>({...e,[t.toLocaleLowerCase()]:r[t](n)}),{}))}}return e.default})());