!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Butter=t():e.Butter=t()}(this,()=>(()=>{"use strict";var r={d:(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},e={};r.d(e,{default:()=>function(e,t={}){if(e)return this instanceof n?n:new n(e,t);throw"ButterCMS API token not set"}});const b="2.0.0",t={author:"authors",category:"categories",content:"content",feed:"feeds",page:"pages",post:"posts",tag:"tags"};function j(e,t){const{onError:n,onRequest:r,onResponse:o,...a}=t.config,{auth_token:s,test:c,preview:i,...u}=t.params;n&&n(e,{options:a,params:u,type:t.type})}function E(e,t,n){t={auth_token:t};return n.testMode&&(t.test=1,t.preview=1),{...e,...t}}function o(v,y){e=v;const R=`https://api.buttercms.com/v2/${t[e]}/`,q=v.replace(v[0],v[0].toUpperCase()),{cancelRequest:w,controller:S}=function(e){if(y.isSSG)return{cancelRequest:()=>{console.warn("Butter API running in SSG-mode and does not cancel requests programmatically")},controller:{}};const t=new AbortController;return{cancelRequest:async function(){await t.abort(e+": Request cancelled")},controller:t}}(q);var e;async function n(e=R,t={}){const{apiToken:n,...r}=y,o=new Headers({"Content-Type":"application/json","X-Butter-Client":"JS/"+b});"undefined"==typeof window&&o.append("Accept-Encoding","gzip");var{config:a,headers:t,params:s}=await async function(e,t,n){const{onError:r,onRequest:o,onResponse:a,...s}=n.config;var c,i;return o?({headers:e,options:c,params:i}=await o(e,{cancelRequest:n.cancelRequest,headers:n.headers,options:s,params:n.params,type:n.type}),{config:{...c,onError:r,onRequest:o,onResponse:a},headers:e,params:E(i,t,c)}):{...n,params:E(n.params,t,s)}}(e,n,{cancelRequest:w,config:r,headers:o,params:t,type:v});try{const{cleanup:y,signal:b}=function(e,t){const{isSSG:n,timeout:r}=a;if(n)return{cleanup:()=>({}),signal:{}};const o=setTimeout(()=>{e.abort(`${t}: Request timed out after ${r}ms.`)},r);return{cleanup:()=>clearTimeout(o),signal:e.signal}}(S,q),j=a.isSSG?{cache:"no-cache",method:"GET",headers:t}:{cache:a.cache,method:"GET",headers:t,signal:b},E=await fetch(e+"?"+new URLSearchParams(s),j);if(y(),200!==E.status)throw{response:E,config:a,params:s};{var c=E;var i={config:a,params:s,type:v};const{onError:u,onRequest:l,onResponse:p,...f}=i.config,{auth_token:d,test:h,preview:g,...m}=i.params;if(p){const u=c.clone();await p(u,{options:f,params:m,type:i.type})}return await c.json();return await void 0}}catch(e){if(e.response){const b=(await e.response.json())["detail"];return j(b,{config:e.config,params:e.params,type:v}),Promise.reject(new Error(b))}{const b=function(e){var{config:e,errorPayload:t,fetchController:n}=e;return!e.isSSG&&n.signal.reason&&n.signal.aborted?n.signal.reason:t}({config:a,errorPayload:e,fetchController:S});return j(b,{config:a,params:s,type:v}),Promise.reject(new Error(b))}}}return{cancelRequest:w,list:async function(e={}){return n(R,e)},retrieve:async function(e,t){return n(R+e+"/",t)},search:async function(e="",t={}){return t.query=e,n(R+"search/",t)}}}const l={Author:function(e={}){var{cancelRequest:e,list:t,retrieve:n}=o("author",e);return{cancelRequest:e,list:t,retrieve:n}},Category:function(e={}){var{cancelRequest:e,list:t,retrieve:n}=o("category",e);return{cancelRequest:e,list:t,retrieve:n}},Content:function(e={}){var{cancelRequest:e,retrieve:t}=o("content",e);return{cancelRequest:e,retrieve:t}},Feed:function(e={}){var{cancelRequest:e,retrieve:t}=o("feed",e);return{cancelRequest:e,retrieve:t}},Page:function(e={}){const{cancelRequest:t,retrieve:r,search:n}=o("page",e);return{cancelRequest:t,list:async(e,t)=>r(e,t),retrieve:async(e,t,n)=>r(e+"/"+t,n),search:n}},Post:function(e={}){var{cancelRequest:e,list:t,retrieve:n,search:r}=o("post",e);return{cancelRequest:e,list:t,retrieve:n,search:r}},Tag:function(e={}){var{cancelRequest:e,list:t,retrieve:n}=o("tag",e);return{cancelRequest:e,list:t,retrieve:n}}};function n(e,t){var n,r,{cache:t="default",isSSG:o=!1,onError:a=null,onRequest:s=null,onResponse:c=null,testMode:i=!1,timeout:u=3e3}=t;return{version:b,...(n=l,r={apiToken:e,isSSG:o,cache:t,onError:a,onRequest:s,onResponse:c,testMode:i,timeout:u},Object.keys(n).reduce((e,t)=>({...e,[t.toLocaleLowerCase()]:n[t](r)}),{}))}}return e.default})());